<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="AnalyzeData.aspx.cs" Inherits="iHRM.WebPC.Cpanel.QuetThe.AnalyzeData" %>

<%@ Register Src="../UC/ImageUploader.ascx" TagName="ImageUploader" TagPrefix="uc1" %>

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
    <link href="/Cpanel/Skins/Style/style.css" rel="stylesheet" />
    <script type="text/javascript" src="/Cpanel/Skins/Js/jquery-1.9.0.js"></script>
    <script src="/Cpanel/Lng/language.js"></script>

    <!--Reference the SignalR library. -->
    <%--<script type="text/javascript" src="/Scripts/jquery.signalR-1.1.4.min.js"></script>--%>
    <!--Reference the autogenerated SignalR hub script. -->
    <%--<script type="text/javascript" src="/signalr/hubs"></script>--%>

    <script type="text/javascript">
        $(document).ready(function () {
            Ext.onReady(function () {
                Ext.Ajax.timeout = 60000;
            });
        });
    </script>
    <style type="text/css">
        .tt_statusCode { height: 12px; margin-top: -4px; }
        .t1 { padding-top:5px; }
        .t1 label { margin-right: 10px; }
    </style>
</head>
<body>
    <form id="form1" runat="server">
        <div>
            <ext:ResourceManager ID="ResourceManager1" runat="server" />
            <ext:Hidden ID="h_FileAttacked" runat="server" />
            <ext:Hidden ID="h_Importer" runat="server" />
            <ext:Hidden runat="server" ID="h_name_depSelected" />
            <ext:Hidden runat="server" ID="h_depSelected" />

            <ext:Viewport ID="Viewport1" runat="server" Layout="BorderLayout" HideBorders="true" AutoScroll="true">
                <Items>
                    <ext:Panel runat="server" Region="North" Border="false" LabelWidth="50" Height="90" Layout="FormLayout" Padding="10">
                        <Items>
                            <ext:Label runat="server" HideLabel="true" Text="#QuetThe_AnalyzeData.lblNote" />
                            <ext:CompositeField runat="server" HideLabel="true">
                                <Items>
                                    <ext:Label runat="server" Text="#QuetThe_AnalyzeData.lbTuNgay" />
                                    <ext:DateField ID="txtDate1" runat="server" Format="dd/MM/yyyy" />
                                    <ext:Label runat="server" Text="#QuetThe_AnalyzeData.lbDenNgay" />
                                    <ext:DateField ID="txtDate2" runat="server" Format="dd/MM/yyyy" />
                                    
                                    <ext:Button ID="btnChotCong" runat="server" Icon="Lock" Text="Chốt công" OnDirectClick="btnChotCong_DirectClick">
                                        <Listeners>
                                            <Click Handler="return confirm(LngGet('Lng.QuetThe_AnalyzeData.msgConfirmLock'))" />
                                        </Listeners>
                                    </ext:Button>

                                    <ext:Button ID="btnBoChotCong" runat="server" Icon="LockBreak" Text="Mở chốt" OnDirectClick="btnBoChotCong_DirectClick">
                                        <Listeners>
                                            <Click Handler="return confirm(LngGet('Lng.QuetThe_AnalyzeData.msgConfirmUnLock'))" />
                                        </Listeners>
                                    </ext:Button>

                                </Items>
                            </ext:CompositeField>
                            
                            <ext:CompositeField runat="server" HideLabel="true">
                                <Items>
                                    
                                    <ext:TriggerField ID="txtMaNVSearch" runat="server" BlankText="Mã nhân viên" EmptyText="Mã nhân viên">
                                        <Triggers>
                                            <ext:FieldTrigger Icon="Clear" HideTrigger="true" />
                                        </Triggers>
                                        <Listeners>
                                            <Change Handler="this.triggers[0][ this.getRawValue().toString().length == 0 ? 'hide' : 'show']();" />
                                            <TriggerClick Handler="if (index == 0) { this.setValue(''); this.triggers[0].hide(); }" />
                                        </Listeners>
                                    </ext:TriggerField>

                                    <ext:DropDownField EmptyText="#Luong_ReportMonth.chonPB" ID="cbophong" runat="server" Editable="false" Width="300" TriggerIcon="SimpleArrowDown" HideLabel="true" AnchorHorizontal="100%" NoteAlign="Top">
                                        <Component>
                                            <ext:TreePanel
                                                ID="TreeFunc"
                                                runat="server"
                                                Title="#Luong_ReportMonth.dsPB"
                                                Icon="Accept"
                                                Height="300"
                                                Shadow="None"
                                                UseArrows="true"
                                                AutoScroll="true"
                                                Animate="true"
                                                EnableDD="true"
                                                ContainerScroll="true"
                                                RootVisible="false">
                                                <SelectionModel>
                                                    <ext:DefaultSelectionModel />
                                                </SelectionModel>
                                                <LoadMask ShowMask="true" />
                                                <DirectEvents>
                                                    <DblClick OnEvent="btnEdit_DirectClick" />
                                                </DirectEvents>

                                            </ext:TreePanel>
                                        </Component>
                                        
                                        <Triggers>
                                            <ext:FieldTrigger Icon="Clear" />
                                        </Triggers>
                                        <Listeners>
                                            <TriggerClick Handler="if (index == 0) { this.clearValue(); h_depSelected.setValue(''); h_name_depSelected.setValue(''); }" />
                                            <Expand Handler="this.component.getRootNode().expand(true);" Single="true" Delay="10" />
                                        </Listeners>
                                    </ext:DropDownField>
                                    
                                    <ext:ComboBox ID="cmbNhom1" runat="server" FieldLabel="Nhóm 1" Editable="false" DisplayField="gName" ValueField="id" EmptyText="Xử theo nhóm 1">
                                        <Store>
                                            <ext:Store ID="StoInGroup1" runat="server">
                                                <Reader>
                                                    <ext:JsonReader IDProperty="id">
                                                        <Fields>
                                                            <ext:RecordField Name="id" />
                                                            <ext:RecordField Name="gName" />
                                                        </Fields>
                                                    </ext:JsonReader>
                                                </Reader>
                                            </ext:Store>
                                        </Store>
                                        
                                        <Triggers>
                                            <ext:FieldTrigger Icon="Clear" HideTrigger="true" />
                                        </Triggers>
                                        <Listeners>
                                            <Select Handler="this.triggers[0].show();" />
                                            <BeforeQuery Handler="this.triggers[0][ this.getRawValue().toString().length == 0 ? 'hide' : 'show']();" />
                                            <TriggerClick Handler="if (index == 0) { this.clearValue(); this.triggers[0].hide(); }" />
                                        </Listeners>
                                    </ext:ComboBox>
                                    
                                    <ext:DisplayField runat="server" Width="15" />
                                    <ext:Checkbox ID="chkNotOverideModified" runat="server" />
                                    <ext:Label runat="server" Text="Đưa về dữ liệu GỐC" />
                                    <ext:Button ID="btnExecute" runat="server" Icon="PlayBlue" Text="Analyze" AutoPostBack="true" OnClick="btnExecute_Click">
                                        <Listeners>
                                            <Click Handler="return confirm(LngGet('Lng.QuetThe_AnalyzeData.msgConfirm'))" />
                                        </Listeners>
                                    </ext:Button>

                                </Items>
                            </ext:CompositeField>
                            
                        </Items>
                    </ext:Panel>

                    <ext:Panel ID="pnlLog" runat="server" Border="false" Region="Center" Layout="FitLayout">
                        <Items>
                            <ext:TextArea ID="txtLog" runat="server" ReadOnly="true">
                            </ext:TextArea>
                        </Items>
                    </ext:Panel>
                </Items>
            </ext:Viewport>
        </div>

    </form>
</body>
</html>
